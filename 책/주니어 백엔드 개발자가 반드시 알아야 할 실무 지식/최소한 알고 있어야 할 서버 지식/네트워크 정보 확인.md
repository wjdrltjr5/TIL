# 네트워크와 정보 확인
서버를 운영하다 보면 네트워크 연결이 정상인지 확인해야 할 때가 있다.

## IP 정보 확인하기
서버의 ip 주소를 알고 싶다면 ipconfig 명령어를 사용한다.
```
$ ifconfig
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.1.100  netmask 255.255.255.0  broadcast 192.168.1.255
        inet6 fe80::a00:27ff:fe8f:8a4a  prefixlen 64  scopeid 0x20<link>
        ether 08:00:27:8f:8a:4a  txqueuelen 1000  (Ethernet)
        RX packets 12345  bytes 8765432 (8.7 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 54321  bytes 9876543 (9.8 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 2000  bytes 200000 (200.0 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 2000  bytes 200000 (200.0 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
        
```
ifconfig 는 각 네트워크 인터페이스 별로 ip주소를 포함한 정보를 보여준다. 예시에서 eht0은 일반적인 네트워크 인터페이스이고 lo는 로컬 루프백 인터페이스다. 
- inet : ip 주소
- inet6 : ipv6 주소
- ether : mac 주소

이외에도 RX, TX로 수신/전송된 패킷 수와 바이트 크기를 확인할 수 있다.

## nc 명령어로 연결 확인하기
요즘 서버 프로그램은 다양한 내부/외부 서비스와 연동을 하는데 종종 연결이 불안정할 떄가 있다. 이럴 때는 네트워크 연결이 정상적으로 이루어지는지 확인할 필요가 있다.

보통 가장 먼저 확인하는 작업은 해당 서버의 특정 포트로 연결이 잘 되는지 확인하는 것이다. 특정 포트로 연결이 잘 되는지 확인할 때 사용할 수 있는 명령어로 nc가 있다.

nc를 이용해서 443 포트로 연결이 되는지 확인하는 명령어
```shell
$ nc -z -v www.daum.net 443
```

-z 옵션은 데이터 전송 없이 특정 포트가 열려 있는지만 확인한다 -v 옵션은 추가 정보를 출력한다. UDP 포트가 열려있는지 확인하려면 -u 옵션을 추가로 사용하면 된다.

외부 서버의 API 호출 결과를 확인하고 싶을 때는 curl이나 wget을 사용한다. 이둘을 사용하면 손쉽게 GET이나 POST 요청을 보내고 응답을 확인할 수 있다.

nc를 사용하면 특정 포트를 사용하는 서버를 구동할 수도 있다. 이를 사용하면 실제 서버 프로세스를 구동하기 전에 두 노트간에 통신이 제대로 종작하는지 확인할 수 있다.
```shell
$ nc -l -v -p 1234
```
-l 옵션은 리스닝 모드, 즉 서버 모드를 뜻한다 -p는 클라리언트 요청을 수신할 포트를 의미한다. 참고로 클라리언트가 연결하면 nc 프로그램이 종료되므로 연결 확인이 필요할 때마다 실행해야 한다.

## netstat 명령어로 포트 사용 확인
서버 프로세스가 구동되어 있는데 해당 포트로 연결이 안되다면, 실제 포트로 클라이언트 연결을 기다리고 있는지 확인해야 하는데 이때 사용할 수 있는 명령어가 netstat이다.

netstat 명령어를 사용하면 현재 사용 중인 소켓의 IP와 포트를 확인할 수 있다.

현재 서버에서 열려 있는 서버 포트확인 명령어
```shell
netstat -lputn
```
- -l : 리스닝 서버 소켓을 출력한다.
- -p : 소켓을 사용하는 PID/프로그램 이름을 출력한다.
- -u : UDP 소켓을 출력한다.
- -t : TCP 소켓을 출력한다.
- n : 포트나 주소를 숫자로 출력한다.

현재 사용 중인 전체 포트를 확인하고 싶다면 -a 옵션을 사용한다. grep 명령어와 함께 사용하면 원하는 포트를 쉽게 확인할 수 있다.
```shell
netstat -anp | grep 12931
```
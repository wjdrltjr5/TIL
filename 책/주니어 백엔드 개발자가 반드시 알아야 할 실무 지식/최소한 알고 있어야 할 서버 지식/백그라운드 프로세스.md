# 백그라운드 프로세스

tail, top, vi 처럼 서버에 접속한 뒤 터미널에서 실행하는 프로그램은 기본적으로 포그라운드 프로세스로 실행된다.

포그라운드 프로세스는 터미널에 연결된 프로세스로, 키보드나 스크린을 통해 사용자와 상호작용한다. 포그라운드 프로세스는 터미널과 연결되어 있기 때문에 사용자와 터미널의 연결이 끊기면 종료된다.

톰캣 같은 서버 프로세스는 항상 실행되어 있어야 한다. 서버 프로그램은 포그라운드 프로세스로 실행되지 않고 백그라운드 프로세스로 실행한다.

백그라운드 프로세스는 터미널과 연결되지 않은 프로세스를 말한다. 터미널과 연결되어 있지 않으므로 키보드나 스크린을 통해 사용자와 상호 작용할 수 없다.

리눅스에서 프로세스를 백그라운드로 실행하려면 명령어 뒤에 &를 붙이면된다.
>$ java -Dserver.port = 9090 -jar server.jar &

명렁어 뒤에 &를 붙이면 프로세스가 백그라운드로 실행되므로, 다른 포그라운드 작업을 동시에 할 수 있다. &를 붙이면 백그라운드로 프로세스가 실행되긴 하지만, 사용자가 로그아웃하면 터미널에서 실행한 백그라운드 프로세스가 함께 종료될 수도 있다.

터미널을 종료해도 백그라운드 프로세스가 계속 실행되게 하려면 추가로 nohub 명령어와 &를 함께 사용한다.

```shell
$ nohup java -Dserver.port = 9090 -jar server.jar & [1] 12345
$ nohup: ignoring input and appending output to 'nohup.out'
```

nohup : No Hang Up을 뜻하는 명령어로 로그아웃처럼 터미널 연결이 끊길 떄 전송되는 HUP 시그널이 프로세스에 전달되지 않게 한다. HUP 시그널을 처리하는 방식은 프로그램마다 다르며, HUP시그널을 받는다고 해서 반드시 프로세스가 종료되는 것은 아니다.

nohup 명령어로 실행한 프로세스가 콘솔에 출력하는 내용은 기본적으로 nohup.out 파일에 기록된다. 다른 파일에 기록학고 싶다면 다음 코드처럼 리눅스의 리디렉션을 사용하면 된다.

>$ nohub java -Dserver.port = 9090 -jar server.jar > server.log 2>&1 &

위 코드는 프로세스가 콘솔에 출력하는 메시지를 server.log에 기록하게 한다.

2>&1 : 표준 오류를 표준 출력과 동일한 경로로 전달하라는 의미
- 2 : 표준 오류
- \> : 리디렉션 연산
- &1 : 표준 출력

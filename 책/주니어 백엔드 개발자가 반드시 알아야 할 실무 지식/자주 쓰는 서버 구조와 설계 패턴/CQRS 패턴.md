# CQRS 패턴
아주 단순한 시스템은 상태 변경과 상태 조회가 동일한 모습을 갖지만 조금만 복잡해져도 상태 변경에 사용하는 데이터와 상태 조회 시 사용하는 데이터에 차이가 발생한다.

주문을 생성할 떄는 주문ID, 회원ID, 배송지 주소, 상품ID와 같은 데이터를 사용한다. 반면에 주문 정보를 조죄할 때는 이들 정보 외에도 회원 이름, 상품명과 같은 데이터를 추가로 사용한다. 명령과 조회에서 사용하는 데이터가 서로 다른것

명령과 조회가 서로 다른 데이터를 사용하는데도 하나의 모델로 명령과 조회를 모두 구현하면, 모델이 복잡해지고 코드 유지보수가 어려워진다.

시간이 지날수록 모델은 추가되는 기능을 지원하기 위해 점점 커지게 되고, 이는 유지보수를 더 어렵게 만든다. 도메인이 복잡해질 경우 CQRS패턴을 사용해서 단일 모델 사용으로 인해 발생하는 복잡도 문제를 해결할 수 있다.

CQRS는 Command Query Responsibility Segregation의 약자로 명령을 위한 모델과 조회를 위한 모델을 분리하는 패턴이다.

CQRS는 명령 모델과 조회 모델을 구분하므로 각 기능에 맞게 모델을 구현할 수 있다는 이점이 있다. 단일 모델을 사용할 경우 조회 기능 때문에 명령 기능이 영향을 받거나, 반대로 명령 기능 떄문에 조회 기능이 영향을 받을 수 있다.

CQRS는 두 모델을 분리함으로써 이런 상호 영향 문제를 최소화할 수 있다. 또한 조회 모델이 별도로 존재하므로 조회 성능을 향상시키기 쉽다. 조회 모델에 캐시를 적용하거나 조회 전용 DB를 확장하는 방식이 이에 해당하낟.

단점도 있다. 각 기능마다 모델을 따로 만들어야 하므로 작업해야할 코드가 늘어난다. 단순한 모델에 CQRS를 적용하면 작업량만 늘어나가 얻는 이점은 적을 수 있다. 반면에 모델이 복잡한 경우에는 CQRS를 통해 얻는 이점이 더 클 간으성이 높다.

또 다른 단점은 구현 기술이 늘어날 수 있다는 점이다. 명령 모델과 조회 모델을 서로 다른 기술로 구현할 때도 많은데 특히 높은 트래픽을 처리하기 위해 조회 모델을 별도 조회 전용 DB에 구축하는 경우가 있다. 이 경우에는 서로 다른 DB간의 데이터 동기화를 위해 추가적인 메시징 수단을 도입해야 한다.

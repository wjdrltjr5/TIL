# 이벤트 기반 아키텍처
이벤트 기반 아키텍처는 두 시스템 간에 통신할 때 이벤트를 사용하는 구조다. 여기서 말하는 이벤트는 과거게 발생한 사실을 의미하기 때문에 주문함, 인증에 실패함 처럼 과거형으로 표현한다.

이벤트 기반 아키텍처는 다음의 3가지 구성 요소로 이루어진다.
- 이벤트 생산자
- 이벤트 소비자
- 이벤트 브로커(또는 라우터)

이벤트 생산자는 이벤트를 생성해서 브로커에게 전달하고, 브로커는 해당 이벤트에 관심있는 소비자에게 이벤트를 전달한다.

이벤트 소비자는 이벤트를 받아 적절하게 대응한다. 이벤트는 변경된 데이터를 다른 시스템에 전달할 때 주로 사용된다. (주문 시스템에서 결제완료 이벤트가 발생하면 이 이벤트가 배송 시스템으로 전달되고 배송시스템은 전달받은 주문정보를 바탕으로 배송을 시작한다.)

이벤트는 메세지의 한 형태로 볼 수 있다. 이벤트를 전달하는 데 보통 메시징 기술을 사용하는데 카프카는 이벤트 브로커로 많이 활용되는 대표적인 예다.

이벤트 기반 아키텍처의 장점 중 하나는 생산자와 소비자가 직접 연결되지 않고 브로커를 통해 간접적으로 연결된다는 점이다. 덕분에 서로 간섭하지 않고 독립적으로 배포할 수 있으며, 새로운 소비자 추가도 용이하다.

반면 이벤트가 중간 브로커를 거치기 떄문에 이벤트의 처리 상태를 추적하려면 별도의 추가 수단이 필요하다.

> 이벤트 브로커와 단일 진실 공급원 : 이벤트 브로커를 단일 진실 공급원으로 확장해서 사용하는 방식도 있다. 예로 카프카는 메시지를 삭제하지 않고 저장할 수 있는데 이 특성을 활용하면 생산자가 보낸 모든 이벤트를 영구 보관할 수 있다. 시스템의 모든 상태 변화가 이벤트로 발생한다면 이벤트 기록만으로도 시스템 상태의 변화를 추적할 수 있다. 더 나아가 카프카 같은 브로커를 이벤트 소싱 패턴의 이벤트 저장소로도 활용할 수 있다.
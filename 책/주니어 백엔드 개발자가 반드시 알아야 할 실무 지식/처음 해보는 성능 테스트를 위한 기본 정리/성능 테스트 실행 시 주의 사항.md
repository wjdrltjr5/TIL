# 성능 테스트 실행 시 주의 사항
성능 테스트를 진행할 때 흔히 하는 실수 중 하나가 테스트 대상 시스템과 부하기를 한 장비에서 실행하는 것이다.

부하 생성은 그 자체로 많은 자원을 사용한다 따라서 테스트 대상 시스템과 부하기를 한 장비에서 실행하면 테스트 대상 시스템이 자원을 온전히 활용하지 못해 실제 성능보다 낮은 결과가 나온다.

성능 테스트를 진행할 때는 부하 발생기와 테스트 대상 시스템을 분리해야 한다. 부하를 발생할 장비의 성능도 중요하다. 대량의 부하를 발생시켜야 하는데 장비의 성능이 나쁘면 부하 자체를 제대로 발생시킬 수 없다.

서버 설정에 제한을 걸고 부하 테스트를 실행하는 것도 자주 하는 실수다. 예로 Nginx를 사용하는데 DDos 공격을 막기 위해 limit_req_zone 설정을 사용해서 IP당 초당 요청 개수를 10개로 제한하면 제대로 테스트 할 수 없다.

비슷하게 서버의 스레드 풀 개수나 DB 커넥션 풀의 크기가 작으면 부하 테스트가 제대로 이루어지지 않으니 테스트할 부하 규모에 맞게 풀의 크기를 미리 설정해야 한다.

운영 시스템과 동일한 네트워크 환경에서 부하 테스트를 진행하는 것도 조심해야 한다. 스트레스 테스트처럼 대량의 요청을 발생시킬 떄는 테스트 대상 시스템에 많은 네트워크 트래픽이 발생한다.

실 운영 시스템과 테스트 대상 시스템을 동일 네트워크에 넣고 테스트를 실행하면 테스트가 발생시키는 트래픽이 실 운영 환경에 영향을 줄 수 있다.

외부 서비스를 연동하는 기능을 테스트할 때는 실제 외부 서비스를 사용하지 않게 주의해야 한다. `테스트를 하고 싶은 대상은 우리 시스템이지 외부 시스템이 아니기 때문이다.` 

외부 시스템 연동을 그대로 둔채 부하 테스트를 진행하면 외부 시스템이 트래픽을 견디지 못하고 장애가 발생할 수 있다.

외부 시스템 연동이 포함된 기능에 대해 부하 테스트를 진행해야 한다면 실제 외부 서비스 대신에 가짜 외부 서비스로 대체해야 한다.

테스트 대상 시스템은 최대한 실제 운영 환경과 동일하게 구성해야 한다. 유효한 성능 지표를 구하려면 최대한 실 환경에 맞춰야 한다.

# 성능 테스트를 설계할 때는 다음 사항들을 고려해야 한다.
- 시스템의 트래픽 패턴
- 동시 요청 사용자 수 / 트래픽 규모
- 기능별 요청 비율
- 데이터 크기
- 워밍업
- 적절한 목표치 설정

시스템은 보통 일정한 트래픽 패턴을 가진다. 일부 서비스는 시간에 따라 트래픽 편차가 크지 않지만 일부는 특정 시간대에 트래픽이 집중되기도 한다.

트래픽이 짧은 시간에 증가하는 패턴을 보인다면 성능 테스트도 짧은 시간 간격으로 부하를 늘리는 방식으로 설계한다.

업무 시스템은 부하가 점진적으로 증가하기 보다는 특정 시간에 목표로 하는 부하가 발생하므로 해당 부하를 바로 발생하도록 성능 테스트를 설계한다.

동시에 사용하는 사용자 규모도 고려한다. 부하에 사용할 사용자 수도 중요하다. 한 사용자의 인증 토큰을 사용해서 모든 요청을 생성한다면 시스템은 실제보다 더 좋은 성능을 낼 수 있다(예로 DB 캐싱)

사용자에 따라 조회하는 데이터가 다르다면 목표로 하는 동시 사용자 수에 맞춰 요청을 발생시킬 수 있도록 테스트를 설계해야 한다.

부하 테스트를 설계할 때는 기능별 트래픽 비율도 고려해야 한다. 자주 불리는 API 목록을 추리고 최대한 실제 호출되는 비율에 맞게 부하가 발생하도록 테스트를 설계한다.

실제 불리는 비율을 고려하지 않고 1개 API에 대해서만 부하를 발생하면 결과가 실제보다 잘 나올 수 있다.

데이터 크기도 고려한다. 데이터가 100만 건이 예상되는 서비스에 대해 부하 테스트를 하는데 DB에 데이터를 50건만 넣으면 많은 경우 의미가 없다.

테스트를 진행하기에 앞서 워밍업이 필요할 때도 있다. 레디스를 캐시로 사용하는 서비스에 대해 부하 테스트를 진행하는 경우

부하 테스트의 목적이 트래픽이 몰리는 상황에서 캐시를 비울 때 어느 정도 성능이 나오는지 확인하기 위한 것이 아니라면 캐시가 어느 정도 찬 다음에 부하 테스트를 진행해야 올바른 결과를 얻을 수 있다.

적절한 목표치도 중요하다 실제 예상되는 사용자 수와 요청 건수를 감안해서 성능 목표치를 설정하자.
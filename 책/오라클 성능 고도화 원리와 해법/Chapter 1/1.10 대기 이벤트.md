# 대기 이벤트

## 대기 이벤트란?

오라클 인스턴스도 조직화된 분업사회처럼 많은 프로세스(혹은 스레드)들이 역할을 분담해서 맡은 바 임무를 수행한다.

프로세스간 커뮤니케이션과 상호작용이 필요하고 떄로는 다른 프로세스가 일을 마칠때 까지 기다려야만 하는 상황이 자주 발생한다.

오라클 프로세스는 일을 계속 진행할 수 있는 조건이 충족 될때까지 수면 상태에 빠지는에 이런 현상이 발생하는 것을 대기 이벤트라고 한다.

그리고 그떄마다 오라클은 그 상태정보를 파일 또는 SGA 메모리 내에 저장해 둔다.

대기 이벤트를 시스템 커널 레벨에서 설명하면, 프로세스가 할 일
모두 마쳤거나 다른 프로세스를 기다려야 하는 상황에서 CPU를 쥔 채 대기하면 불필요하게 CPU 자원을 낭비하는 것이므로 CPU를 OS에 반환하고 수면 상태로 빠지는 것을 말한다. (대기큐로 이동)

## 대기 이벤트는 언제 발생할까?

-   자신이 필요로 하는 특정 리소스가 다른 프로세스에 의해 사용 중일때

-   다른 프로세스에 의해 선행작업이 완료되기를 기다릴때

    -   ex. DBWR가 Dirty 버퍼를 디스크에 기록할 때는 먼저 LGWR가 로그 버퍼에 있는 Redo entry를 Redo Log파일에 기록하는 작업이 선행되어야 한다.

-   할 일이 없을 때
    -   Array 크기만큼 데이터를 전송하고 다음 Fetch Call을 기다릴때

## 대기 이벤트는 언제 사라질까?

선행 프로세스가 자신을 깨우지 않더라도 타이머에 설정된 시간이 도래할때마다 한번씩 깨어나 자신이 기다리던 리소스사 사용가능해졌거나 할일이 생겼는지 확인한다.

타임아웃 설정값은 대기 이벤트마다 모두 다르다.

대기중이던 프로세스가 활동을 재개하는 시점

-   대기 상태에 빠진 프로세스가 기다리던 리소스가 사용가능해 지거나
-   작업을 계속 진행하기 위한 선행 작업이 완료되거나.
-   해야 할 일이 생겼을때

## 래치와 대기 이벤트 개념 명확화

OWI(Oracle Wait Interface)를 따로 공부한 사람조차도 래치와 대기 이벤트를 구분 못하는 경우를 종종 보는데 래치와 대기 이벤트는 구분되어야 한다.

래치를 얻는 과정 자체가 경합을 의미하지는 않는다. 공유된 자원을 읽으려면 래치를 얻는 것이 당연한 일이다. 단지 그 과정에서 다른 프로세스와 경합이 발생하는지를 관심있게 살펴봐야 하며, 만약 그렇다면 시스템의 동시성이 저하된다.

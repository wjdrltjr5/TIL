# 세션 커서 캐싱

하드파싱을 하지 않더라도 SQL 구문을 분석해서 해시값을 계산하고 library cache 래치를 획득한 후 라이브러리 캐시에서 커서를 탐색하는 과정 자체도 부담스러운 작업이다.

Shared Pool에 위치한 공유 커서를 실행하려고 PGA로 인스턴스한 것이 세션커서이다.

`오라클은 자주 수행되는 SQL에 대한 세션커서를 세션 커서 캐시에 저장할 수 있는 기능을 제공하는데 이를 세션 커서 캐싱이라고 한다.`

이 기능을 활성화하면 Parse Call 횟수를 확인해보고 그값이 3이상이면 세션 커서를 세션 커서 캐시로 옮긴다.

세션 커서 캐시에는 SQL텍스트와 함께 공유 커서를 가리키는 포인터를 저장한다. 커서는 닫힌 상태지만 공유 커서에 대한 참조를 유지하기 때문에 다음 수행시 더 빨리 커서를 오픈할 수 있다.

따라서 자주 수행되는 SQL문에 의해 발생하는 라이브러리 캐시 부하를 경감시킬 수 있다

SQL문을 파싱해서 구문을 분석하고 라이브러리 캐시에서 커서를 찾는 과정에서 소모되는 CPu사용량을 줄이고 소프트 파싱과정에서 발생하는 래치 요청 횟수를 감소시키는 효과를 가져온다. (캐시는 LRU 알고리즘 사용)

이후 실행 시 **Parse 생략 → Bind + Execute만 수행**

-   `SESSION_CACHED_CURSORS` 이 파라미터 값이 0보다 커야 함
-   SQL 반복 실행 횟수가 동일 SQL이 3회 이상 실행되어야 적용됨
-   바인드 변수 기반 쿼리여야 효과적

모니터링 SQL 예시

```sql
SELECT sql_text, executions, parse_calls
FROM v$sql
WHERE executions > 1 AND parse_calls > executions;

```

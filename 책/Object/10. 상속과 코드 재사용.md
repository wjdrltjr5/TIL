# 상속과 코드 재사용

## 상속과 중복 코드

### DRY 원칙

Don't Repeat Yourself

신뢰할 수 있고 수정하기 쉬운 소프트웨어를 만드는 효과적인 방법 중 하나는 중복을 제거하는 것.

요구사항이 변경됐을 때 두 코드를 함께 수정해야 한다면 이 코드는 중복이다.

DRY 원칙 : 모든 지식은 시스템 내에서 단일하고, 애매하지 않고, 정말로 믿을 만한 표현 양식을 가져야 한다.

### 중복과 변경

### 상속을 이용해서 중복 코드 제거하기

상속을 이용해 코드를 재사용하기 위해서는 부모클래스의 개발자가 세웠던 가정이나 추론 과정을 정확하게 이해해야 한다. 이것은 자식클래스의 작성자가 부모 클래스의 구현 방법에 대한 정확한 지식을 가져야 한다는 것을 의미한다. 따라서 상속은 결합도를 높인다.

상속이 초래하는 부모 클래스와 자식 클래스 사이의 강한 결합이 코드를 수정하기 어렵게 만든다.

**자식 클래스의 메서드 안에서 super참조를 이용해 부모 클래스의 메서드를 직접 호출할 경우 두 클래스는 강하게 결합된다. super호출을 제거할 수 있는 방법을 찾아 결합도를 제거하라.**

## 취약한 기반 클래스문제

부모 클래스의 변경에 인해 자식 클래스가 영향을 받는 현상을 취약한 기반 클래스문제(Fragile Basic Class Problem, Brittle Base Class Problem)라고 부른다.

상속 관계를 추가할수록 전체 시스템의 결합도가 높아진다는 사실을알고 있어야 한다.

상속은 자식 클래스가 부모클래스의 구현 세부사항이 의존하도록 만들기 때문에 캡슐화를 약화시킨다.

### 불필요한 인터페이스 문제

**상속받은 부모 클래스의 메서드가 자식 클래스의 내부 구조에 대한 규칙을 깨트릴 수 있다.**

### 메서드 오버라이딩 문제

**자식 클래스가 부모 클래스의 메서드를 오버라이딩할 경우 부모 클래스가 자신의 메서드를 사용하는 방법에 자식 클래스가 결합될 수 있다.**

클래스가 상속되기를 원한다면 상속을 위해 클래스를 설계하고 문서화해야 하며 그렇지 않은경우 금지해야한다.

캡슐화된 내부 구현을 문서화 하는 것이 옳은가? -> 설계는 항상 트레이드 오프

상속은 코드 재사용을 위해 캡슐화를희생한다. 완벽한 캡슐화를 원한다면 코드 재사용을 포기하거나 상송 이외의 다른 방법을 사용해야 한다.

### 부모 클래스와 자식 클래스의 동시 수정 문제

**클래스를 상속하면 결합도로 인해 자식 클래스와 부모 클래스의 구현을 영원히 변경하지 않거나, 자식 클래스와 부모 클래스를 동시에 변경하거나 둘 중 하나를 선택할 수 밖에 없다.**

## Phone 다시 살펴보기

### 추상화에 의존하자.

코드 중복을 제거하기 위해 상속을 도입할 떄 따르는 두 가지 원칙

-   두 메서드가 유사하게 보인다면 차이점을 메서드로 추출하라. 메서드 추출을 통해 두 메서드를 동일한 형태로 보이도록 만들 수 있다.
-   부모 클래스의 코드를 하위로 내리지 말고 자식 클래스의 코드를 상위로 올려라. 부모 클래스의 구체적인 메서드를 자식 클래스로 내리는 것보다. 자식 클래스의 추상적인 메서드를 부모 클래스로 올리는 것이 재사용과 응집도 측면에서 더 뛰어난 결과를 얻을 수 있다.

### 차이를 메서드로 추출하라.

가장 먼저 할 일은 중복 코드안에서 차이점을 별도의 메서드로 추출하는 것.(변하는 것으로부터 변하지 않는 것을 분리하라.or 변하는 부분을 찾고 이를 캡슐화 하라)

### 중복 코드를 부모 클래스로 옮겨라

### 추상화가 핵심이다.

부모 클래스 여시 자신의 내부에 구현된 추상 메서드를 호출하기 때문에 추상화에 의존한다고 말할 수 있다.

추상화의 의존하기 때문에 새로운 기능역시 추가하기 쉽다 추상메서드만 오버라이딩하면 되기 때문에

### 의도를 드러내는 이름 선택하기

### 세금 추가하기

클래스라는 도구는 메서드뿐 아니라 인스턴스 변수도 함께 포함한다. 따라서 상속은 인스턴스 변수에 대해서도 결합되게 만든다.

부모 클래스에 추가된 인스턴스 변수는 자연스럽게 자식 클래스에도 영향을 미친다 하지만 인스턴스 초기화 로직을 변겨하는 것이 두 클래스에 동일한 코드를 중복시키는 것보다는 현명한 선택이다.

## 차이에 의한 프로그래밍

기존 코드와 다른 부분만을 추가함으로써 애플리케이션의 기능을 확장하는 방법을 차이에 의한 프로그래밍 이라고 부른다.

차이에 의한 프로그래밍의 목표는 중복코드를 제거하고 코드를 재사용 하는것

# 인덱스 스캔 효율화

## 41 인덱스 튜닝의 두 가지 핵심 요소

세부적인 인덱스 튜닝 방법으로 여러 가지가 있지만, 핵심 요소는 크게 두 가지로 나뉜다.

첫 번째는 인덱스 스캔 과정에서 발생하는 비효율을 줄이는 것이다. 즉, 인덱스 스캔 효율화 튜닝이다.

효율이란 들인 노력과 얻은 결과의 비율이다. 인덱스를 스캔한 양에 비해 얻은 결과건수가 적으면 비효율적이다.

인덱스 튜닝의 두 번째 핵심요소는 테이블 액세스 횟수를 줄이는 것이다. 인덱스 스캔 후 테이블 레코드를 액세스할 때 랜덤 I/O방식을 사용하므로 이를 랜덤 액세스 최소화 튜닝이라고 한다.

테이블을 액세스한 양에 비해 얻은 결과 건수가 적으면 비효율적이다.

## 42 인덱스 스캔 효율

테이블과 달리 인덱스에는 같은 값을 갖는 레코드들이 서로 군집해 있다. 같은 값을 찾을 떼 = 연산자를 사용하므로 인덱스 컬럼을 앞쪽부터 누락 없이 = 연산자로 조회하면 조건절을 만족하는 레코드는 모두 모여있다.

따라서 인덱스 스캔 효율은 인덱스 컬럼을 조건절에 모두 등치 조건으로 사용할 떄 가장 좋다.

인덱스 컬럼 중 일부가 조건절에 없거나 = 조건이 아니더라도, 그것이 뒤쪽 컬럼일 떄는 비효율이 없다.

인덱스 선행 컬럼 중 어느 하나가 조건절에 없거나 = 조건이 아닌 연산자로 조회하면 조건절을 만족하는 레코드가 서로 흩어진 상태가 된다.

결국 선행 컬럼이 모두 = 조건인 상태에서 첫 번째 나타나는 범위검색 조건까지만 만족하는 인덱스 레코드는 모두 연속해서 모여 있지만,

그 이하 조건까지 만족하는 레코드는 비교 연산자 종류에 상관없이 흩어진다.

따라서 인덱스 선행 컬럼이 조건절에 없거나 부틍호, BETWEEN, LIKE 같은 범위 검색 조건이면, 인덱스를 스캔하는 단계에서 비효율이 생긴다.

## 43

-   INDEX FAST FULL SCAN은 인덱스에 있는 컬럼만 사용할때 사용가능
-   할인구분코드(선두컬럼)는 NDV가 적은 반면 상품코드는 NDV가 많으므로 INDEX SKIP SCAN이 매우 효과적인 상황
-   선두 컬럼의 NDV는 적고 후행 컬럼의 NDV는 많을 때 BETWEEN 조건의 인덱스 선두 컬럼을 IN 조건으로 변ㄱ여하면 성능 향상에 큰 도움이 되며 가장 흔히 사용하는 튜딩 기법 중 하나다.

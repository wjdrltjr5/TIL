# ì—¬ëŸ¬ í•¨ìˆ˜ë¥¼ ë³€í™˜ í•¨ìˆ˜ë¡œ ë¬¶ê¸°

```JavaScript
function base(aReading){...}
function taxableCharge(aReading){...}
```

<center>ğŸ”½</center>

```JavaScript
function enrichReading(argReading){
  const aReading = _.cloneDeep(argReading);
  aReading.baseCharge = base(aReading);
  aReading.taxableCharge = taxableCharge(aReading);
  return aReading;
}
```

## ë°°ê²½

ì†Œí”„íŠ¸ì›¨ì–´ ë°ì´í„°ë¥¼ ì…ë ¥ë°›ì•„ì„œ ì—¬ëŸ¬ ê°€ì§€ ì •ë³´ë¥¼ ë„ì¶œ. ì´ë ‡ê²Œ ë„ì¶œëœ ì •ë³´ëŠ” ì—¬ëŸ¬ ê³³ì—ì„œ ì‚¬ìš©ë  ìˆ˜ ìˆëŠ”ë°, ì‚¬ìš©ë˜ëŠ” ê³³ ë§ˆë‹¤ ê°™ì€ ë¡œì§ì´ ë°˜ë³µë˜ê¸°ë„ í•œë‹¤.

ì´ëŸ° ë„ì¶œì‘ì—…ë“¤ì„ í•œê³³ìœ¼ë¡œ ëª¨ì•„ ê²€ìƒ‰ê³¼ ê°±ì‹ ì„ ì¼ê´€ëœ ì¥ì†Œì—ì„œ ì²˜ë¦¬í•˜ê³  ì¤‘ë³µ ë¡œì§ì„ ë§‰ëŠ”ë‹¤.

ì´ë ‡ê¸° í•˜ê¸° ìœ„í•œ ë°©ë²•ìœ¼ë¡œ `ë³€í™˜ í•¨ìˆ˜`ë¥¼ ì‚¬ìš© ë³€í™˜ í•¨ìˆ˜ëŠ” ì›ë³¸ ë°ì´í„°ë¥¼ ì…ë ¥ë°›ì•„ì„œ í•„ìš”í•œ ì •ë³´ë¥¼ ëª¨ë‘ ë„ì¶œí•œ ë’¤, ê°ê°ì„ ì¶œë ¥ ë°ì´í„°ì˜ í•„ë“œì— ë„£ì–´ ë°˜í™˜í•œë‹¤.

ì´ ë¦¬íŒ©í„°ë§ ëŒ€ì‹  ì—¬ëŸ¬ í•¨ìˆ˜ë¥¼ í´ë˜ìŠ¤ë¡œ ë¬¶ê¸°ë¡œ ì²˜ë¦¬í•´ë„ ëœë‹¤. (ì›ë³¸ ë°ì´í„°ê°€ ì½”ë“œ ì•ˆì—ì„œ ê°±ì‹ ë  ë•ŒëŠ” í´ë˜ìŠ¤ë¡œ ë¬¶ëŠ”ê²ƒì´ ì¢‹ë‹¤, ë³€í™˜ í•¨ìˆ˜ë¡œ ë¬¶ìœ¼ë©´ ê°€ê³µí•œ ë°ì´í„°ë¥¼ ìƒˆë¡œìš´ ë ˆì½”ë“œì— ì €ì¥í•˜ë¯€ë¡œ ì›ë³¸ ë°ì´í„°ê°€ ìˆ˜ì •ë˜ë©´ ì¼ê´€ì„±ì´ ê¹¨ì§ˆ ìˆ˜ ìˆë‹¤.)

## ì ˆì°¨

-   ë³€í™˜í•  ë ˆì½”ë“œë¥¼ ì…ë ¥ë°›ì•„ì„œ ê°’ì„ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ëŠ” ë³€í™˜ í•¨ìˆ˜ë¥¼ ë§Œë“ ë‹¤

    -   ì´ ì‘ì—…ì€ ëŒ€ì²´ë¡œ ê¹Šì€ë³µì‚¬(ê°’ë³µì‚¬)ë¡œ ì²˜ë¦¬í•´ì•¼ í•œë‹¤.

-   ë¬¶ì„ í•¨ìˆ˜ ì¤‘ í•¨ìˆ˜ í•˜ë‚˜ë¥¼ ê³¨ë¼ì„œ ë³¸ë¬¸ ì½”ë“œë¥¼ ë³€í™˜ í•¨ìˆ˜ë¡œ ì˜®ê¸°ê³ , ì²˜ë¦¬ ê²°ê³¼ë¥¼ ë ˆì½”ë“œì— ìƒˆ í•„ë“œë¡œ ê¸°ë¡í•œë‹¤. ê·¸ëŸ° ë‹¤ìŒ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œê°€ ì´ í•„ë“œë¥¼ ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì •í•œë‹¤.

-   í…ŒìŠ¤íŠ¸ í•œë‹¤

-   ë‚˜ë¨¸ì§€ ê´€ë ¨ í•¨ìˆ˜ë„ ìœ„ ê³¼ì •ì— ë”°ë¼ ì²˜ë¦¬í•œë‹¤.

## ì˜ˆì‹œ

ì„œë¯¼ì—ê²Œ ì°¨ë¥¼ ìˆ˜ë—ë¬¼ì²˜ëŸ¼ ì œê³µí•˜ëŠ” ì„œë¹„ìŠ¤ ë§¤ë‹¬ ë§ˆì‹  ì°¨ì˜ ì–‘ì„ ì¸¡ì •í•´ì•¼ í•¨

```JavaScript
reading = {customer : "ivan", quantity: 10, month: 5, year: 2017};
```

-   ê¸°ë³¸ìš”ê¸ˆì„ ê³„ì‚°í•˜ëŠ” ì½”ë“œ

```JavaScript
//í´ë¼ì´ì–¸íŠ¸ 1
const aReading = acquireReading();
const baseCharge = baseRate(aReading.month, aReading.year) * aReading.quantity
```

-   ì†Œë¹„ëŸ‰ì„ ê³„ì‚°í•˜ëŠ” ì½”ë“œ , ì„¸ê¸ˆì„ ì¼ë¶€ ë©´ì œë°›ì„ ìˆ˜ ìˆë„ë¡ ê¸°ë³¸ ì†Œë¹„ëŸ‰ ë³´ë‹¤ ì ê²Œ

```JavaScript
//í´ë¼ì´ì–¸íŠ¸ 2
const aReading = acquireReading();
const base = (baseRate(aReading.month, aReading.year) * aReading.quantity)
const taxableCharge = Math.max(0, base - taxThreshold(aReading.year));
```

```JavaScript
// í´ë¼ì´ì–¸íŠ¸ 3
const aReading = acquireReading();
const basicChargeAmount = calculateBaseCharge(aReading);

function calculateBaseCharge(aReading){//  ë‹¤ë¥¸ê³³ì—ì„œ ì´ë¯¸ í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ë‘ 
  return baseRate(aReading.month, aReading.year) * aReading.quantity;
}

```

-   í•´ê²° ë°©ë²•ìœ¼ë¡œ íŒŒìƒ ì •ë³´ ê³„ì‚° ë¡œì§ì„ í•˜ë‚˜ì˜ ë³€í™˜ ë‹¨ê³„ë¡œ ëª¨ì€ë‹¤.
-   ë¯¸ê°€ê³µ ì¸¡ì •ê°’ì„ ì…ë ¥ ë°›ì•„ì„œ ë‹¤ì–‘í•œ ê°€ê³µ ì •ë³´ë¥¼ ë§ë¶™ì—¬ ë°˜í™˜

-   ì…ë ¥ ê°ì²´ë¥¼ ê·¸ëŒ€ë¡œ ë³µì‚¬í•´ ë°˜í™˜í•˜ëŠ” ë³€í™˜ í•¨ìˆ˜ë¥¼ ë§Œë“ ë‹¤.

```JavaScript
function enrichReading(original){
  const result = _.cloneDeep(original); // ê¹Šì€ ë³µì‚¬ lodashë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
  return result
}
```

-   ì´ì œ ë³€ê²½í•˜ë ¤ëŠ” ê³„ì‚° ë¡œì§ ì¤‘ í•˜ë‚˜ë¥¼ ê³ ë¥¸ë‹¤. ë¨¼ì € ì´ ê³„ì‚° ë¡œì§ì— ì¸¡ì •ê°’ì„ ì „ë‹¬í•˜ê¸° ì „ì— ë¶€ê°€ ì •ë³´ë¥¼ ë§ë¶™ì´ë„ë¡ ìˆ˜ì •í•œë‹¤.

```JavaScript
//í´ë¼ì´ì–¸íŠ¸ 3
const rawReading = acquireReading(); // ë¯¸ê°€ê³µ ì¸¡ì •ê°’
const aReading = enrichReading(rawReading);
const basicChargeAmount = calculateBaseCharge(aReading);
```

-   calculateBaseCharge() ë¥¼ ë¶€ê°€ ì •ë³´ë¥¼ ë§ë¶™ì´ëŠ” ì½”ë“œ ê·¼ì²˜ë¡œ ì˜®ê¸´ë‹¤.(í•¨ìˆ˜ ì˜®ê¸°ê¸°)

```JavaScript
function enrichReading(original){
  const result = _.cloneDeep(original);
  result.baseCharge = calculateBaseCharge(result); // ë¯¸ê°€ê³µ ì¸¡ì •ê°’ì— ê¸°ë³¸ì†Œë¹„ëŸ‰ì„
  return result;                                  // ë¶€ê°€ ì •ë³´ë¡œ ë§ë¶™ì„
}
```

ë³€í™˜ í•¨ìˆ˜ ì•ˆì—ì„œëŠ” ê²°ê³¼ ê°ì²´ë¥¼ ë§¤ë²ˆ ë³µì œí•  í•„ìš”ì—†ì´ ë§ˆìŒê» ë³€ê²½í•´ë„ ëœë‹¤.

ë¶ˆë³€ ë°ì´í„°ë¥¼ ì„ í˜¸í•˜ì§€ë§Œ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ì–¸ì–´ëŠ” ëŒ€ë¶€ë¶„ ë¶ˆë³€ ë°ì´í„°ë¥¼ ë‹¤ë£¨ê¸° ì–´ë µê²Œ ë¼ ìˆë‹¤. ë°ì´í„°ê°€ ëª¨ë“ˆ ê²½ê³„ë¥¼ ë„˜ë‚˜ë“ ë‹¤ë©´ ë¶ˆë³€ìœ¼ë¡œ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ê² ì§€ë§Œ, ë°ì´í„°ì˜ ìœ íš¨ë²”ìœ„ê°€ ì¢ì„ ë•ŒëŠ” ë§ˆìŒê» ë³€ê²½í•œë‹¤.

```JavaScript
//í´ë¼ì´ì–¸íŠ¸3
const rawReading = acquireReading();
const aReading = enrichReading(rawReading);
const basicChargeAmount = aReading.baseCharge;
```

-   ì´ì œ calculateBaseCharge()ë¥¼ í˜¸ì¶œí•˜ëŠ” ì½”ë“œë¥¼ ëª¨ë‘ ìˆ˜ì •í–ˆë‹¤ë©´, ì´í•¨ìˆ˜ë¥¼ ì¤‘ì²©ì‹œí‚¨ë‹¤. (ê¸°ë³¸ìš”ê¸ˆì„ ì´ìš©í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ëŠ” ë³€í™˜ëœ ë ˆì½”ë“œë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ëŠ” ì˜ë„ë¥¼ ëª…í™•í•˜ê²Œ í‘œí˜„)

-   ì£¼ì˜. enrichReading() ì²˜ëŸ¼ ì •ë³´ë¥¼ ì¶”ê°€í•´ ë°˜í™˜í•  ë–„ ì›ë³¸ ì¸¡ì •ê°’ ë ˆì½”ë“œëŠ” ë³€ê²½í•˜ì§€ ì•Šì•„ì•¼ í•œë‹¤ëŠ” ê²ƒ

```JavaScript
// ì›ë³¸ ì¸¡ì •ê°’ì„ í›¼ì†í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸
it('check reading unchanged', function(){
  const baseReading = {customer: "ivan", quantity: 15, month: 5, year: 2017};
  const oracle = _.cloneDeep(baseReading);
  enrichReading(baseReading);
  assert.deepEqual(baseReading, oracle)
})
```

-   í´ë¼ì´ì–¸íŠ¸1ë„ ì´ í•„ë“œë¥¼ ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì •

```JavaScript
const rawReading = acquireReading();
const aReading = enrichReading(rawReading);
const baseCharge = aReading.baseCharge;
```

-   ì´ì œ ì„¸ê¸ˆì„ ë¶€ê³¼í•  ì†Œë¹„ëŸ‰ ê³„ì‚°ìœ¼ë¡œ ë„˜ì–´ê°€ì„œ ê°€ì¥ ë¨¼ì € ë³€í™˜ í•¨ìˆ˜ë¶€í„° ë¼ì›Œ ë„£ëŠ”ë‹¤.

```JavaScript
const rawReading = acquireReading();
const aReading = enrichReading(rawReading);
const base = (baseRate(aReading.month, aReading.year) * aReading.quantity);
const taxableCharge = Math.max(0, base - taxThreshold(aReading.year));
```

-   ê¸°ë³¸ ìš”ê¸ˆì„ ê³„ì‚°í•˜ëŠ” ë¶€ë¶„ì„ ìƒˆë¡œ ë§Œë“  í•„ë“œë¡œ êµì²´
-   ë³µì¡í•˜ë‹¤ë©´ í•¨ìˆ˜ ì¶”ì¶œí•˜ê¸° ë¶€í„° í•˜ê² ìœ¼ë‚˜ ê·¸ëƒ¥ í•œë²ˆì— ì²˜ë¦¬
-   í•˜ê³  ì¸ë¼ì¸ì²˜ë¦¬ê¹Œì§€

```JavaScript
const rawReading = acquireReading();
const aReading = enrichReading(rawReading);
const taxableCharge = Math.max(0, aReading.baseCharge - taxThreshold(aReading.year));
```

-   ì´ì œ ë˜ ê³„ì‚° ì½”ë“œë¥¼ ë³€í™˜ í•¨ìˆ˜ë¡œ ì˜®ê¹€

```JavaScript
function enrichReading(original){
  const result = _.cloneDeep(original);
  result.baseCharge = calculateBaseCharge(result);
  result.taxableCharge = Math.max(0, result.baseCharge - taxThreshold(result.year));
  return result;
}
```

```JavaScript
const rawReading = acquireReading();
const aReading = enrichReading(rawReading);
const taxableCharge = aReading.taxableCharge;
```

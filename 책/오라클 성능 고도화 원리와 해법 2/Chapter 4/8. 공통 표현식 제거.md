# 공통 표현식 제거

같은 조건식이 여러 곳에서 반복 사용될 경우, 오라클은 해당 조건식이 각 로우당 한 번씩만 평가되도록 쿼리를 변환하는데 이를 공통 표현식 제거라고 하며

\_eliminate_common_subexbr 파라미터를 통해 제어한다.

```sql
select /*+ no_expand */ * from emp e, dept d
where
(e.deptno = d.deptno and e.job = 'CLERK' and d.loc = 'DALLAS')
or
(e.deptno = d.deptno and e.job = 'CLERK' and e.sal >= 1000)


-- 쿼리 변환 후
select * from emp e, dept d
where e.deptno = d.deptno
and e.job = 'CLERK'
and (d.log = 'DALLAS' or e.sal >= 1000)
```

비교 연산을 덜하게 된것도 의미 있지만 새로운 인덱스 액세스 조건이 만들어졌다는 사실이 더 중요하다. (job = 'CLERK')

이 기능이 작동하지 못하도록 \_eliminate_common_subexpr 파라미터를 false로 바꾸면

옵티마이저는 두가지 선택이 가능하다.

-   OR-EXpansion 쿼리 변환 수행
-   두 테이블 모두 Full Scan (or 연산자로 묶인 조건식을 제외하면 인덱스 액세스에 활용할 만한 조건식이 아예 없기 떄문)

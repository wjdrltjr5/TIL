# 집합 연산을 조인으로 변환

Intersect나 Minus 같은 집합 연산을 조인형태로 변환하는 것을 말한다.

```sql
select job, mgr from emp
minus
select job, mgr from emp
where deptno = 10;
```

위 쿼리의 실행계획은 각각 Sort Unique연산을 수행한 후에 Minus연산을 수행하는 것을 볼 수 있다.

아래와 같이 \_convert_set_to_join 파라미터를 true로설정하고 다시 실행계획을 보면

해시 Anti조인을 수행하고 나서 중복 값을 제거하기 위핸 Hash Unique 연산을 수행하는 것을 볼 수 있다.

아래와 같이 쿼리변환이 일어난것

```sql
select distinct job, mgr from emp e
where not exists (select 'x' from emp
                   where deptno = 10
                     and sys_op_map_nonnull(job) = sys_op_map_nonnull(e.job
                     and sys_op_map_nonull(mgr) = sys_op_map_nonnull(e.mgr)))
```

sys_op_map_nonnull 함수는 비공식적인 함수지만 가끔 유용하게 사용할 수 있다.

null 값끼리 = 비교는 false지만 가끔 true가 되도록 처리해야 하는 경우가 이쓴ㄴ데 그럴 때 사용한다. 위 두 쿼리가 null 허용 컬럼이기 때문에 위와 같은 처리

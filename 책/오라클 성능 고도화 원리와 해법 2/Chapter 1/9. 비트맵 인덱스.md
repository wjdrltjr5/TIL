# 비트맵 인덱스

인덱스는 키 값에 해당하는 테이블 레코드를 찾아갈 수 있도록 주소 정보를 제공한다.

일반적으로 사용되는 B\*Tree 인덱스는 테이블 레코드를 가리키는 rowid 목록을 키 값과 함께 저장하는 구조다.

테이블에 100개 레코드가 있으면 인덱스에도 100개 rowid를 키 값과 함께 저장한다.

rowid에는 중복값이 없지만 키에는 중복 값이 있을 수 있다. 개념적으로 볼 때 비트맵 인덱스는 키 값에 중복이 없고, 키 값별로 하나의 비트맵 레코드를 갖는다.

비트맵 상의 각 비트가 하나의 테이블 레코드와 매핑된다. 비트가 1로 설정돼 있으면 상응하는 테이블 레코드가 해당 키 값을 포함하고 있음을 의미한다.

### 키값의 수가 많을 떄

비트맵 인덱스는 키 값별로 하나의 레코드를 갖는데, 저장할 키 값의 수가 아주 많을 때는 한 블록에 모두 담지 못한다.

비트맵을 저장하기 위해 두 개 이상 블록이 필요해지면 오라클은 B\*Tree 인덱스 구조를 사용하며, 값의 수가 많을 수록 인덱스 높이도 증가한다.

## 비트맵 인덱스 활용

비트맵 인덱스는 성별처럼 Distinct Value 개수가 적을 때 저장효율이 매우 좋다.(중복값이 많을 때)

비트맵 인덱스는 여러 인덱스를 동시에 활용할 수 있다는 장점 떄문에 다양한 조건절이 사용되는 특히 정형화 되지 않은 임의 질의가 많은 환경에 적합하다.

비트맵 인덱스는 Lock에 의한 DML부하가 심한 것이 단점이다. 레코드 하나만 변경되더라도 해당 비트맵 범위에 속한 모든 레코드에 lock이 걸린다.

OLTP환경에 비트맵 인덱스를 쓸 수 없는 이유 비트맵 인덱스는 읽기 위주의 대용량 DW (OLAP) 환경에 아주 적합하다.

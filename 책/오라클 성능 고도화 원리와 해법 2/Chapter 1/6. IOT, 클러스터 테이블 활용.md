# IOT, 클러스터 테이블 활용

## IOT란

테이블을 찾아가기 위한 rowid를 갖는 일반 인덱스와 달리 IOT는 모든 행 데이터를 리프 블록에 저장하고 있다.

인덱스 리프 블록이 곧 데이터 블록인셈

```sql
-- 테이블을 인덱스 구조로 만드는 구문
create table index_org_t ( a number primary key, b barchar(10))
organization index;
```

일반적인 힙 구조 테이블로의 데이터 삽입은 Random 방식으로 이루어진다. 즉 Freelist로부터 할당 받은 블록에 정해진 순서 없기 값을 입력한다.

반면 IOT는 인덱스 구조 테이블이므로 정렬 상태를 유지하며 데이터를 삽입한다.

타 DBMS의 클러스터형 인덱스와 비슷한 개념

### IOT의 장점과 단점

IOT는 인위적으로 CF를 좋게 만드는 방법 중 하나다.

같은 값을 가진 레코드들이 100% 정렬된 상태로 모여있기 때문에 Random 액세스가 아닌 Sequential 방식으로 데이터를 액세스할 수 있고 이때문에 넓은 범위를 액세스할 때 유리하다.

IOT의 가장 큰 담점으로는 데이터 입력시 성능이 느리다는 점 실제 테스트 해보면 그럴 정도로 늦지는 않다.

일반 힙 구조 테이블에 PK인덱스를 생성하지 않았을 때와 비교하면 많은 차이가 나지만 PK 인덱스를 두고 비교해보면 차이가 거의 없다.

하지만 성능 차이가 발생하는 이유는 인덱스 분할 발생량 때문

IOT는 인덱스 구조이므로 중간에 꽉 찬 블록에 새로운 값을 입력할 일이 종종 생기고 그럴 떄 인덱스 분할이 발생한다.(B+트리 값추가할때 분할하는 현상 같은 레벨 유지를 위해)

IOT가 PK 이외에 많은 컬럼을 갖는다면 리프 블록에 저장해야할 데이터량이 늘어나 그만큼 액세스 분할 발생빈도도 높아진다.

컬럼 수가 그렇게 많은 테이블이라면 인덱스 스캔 효율 때문이라고 IOT 대상으로는 부적합하다.

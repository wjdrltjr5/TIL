# 병렬 Order By와 Group By

앞절에서 강조했던 P->P 데이터 재분배는 주로 병렬 order by, 병렬 group by, 병렬 조인을 포함한 SQL에서 나타난다.

## 병렬 Order By

order by를 병렬로 수행하려면 테이블 큐를 통한 데이터 재분배가 필요한데 쿼리 수행이 완료된 직후에 같은 세션에서 v$pq_tqstat를 쿼리해보면 테이블 큐를 통한 데이터 전송 통게를 확인해 볼 수 있다.

병렬 쿼리 수행 속도가 예상만큼 빠르지 않다면 테이블 큐를 통한 데이터 전송량에 편차가 크지 않은지 확인해 볼 필요가 있는데 그럴 때 v$pq_tqstat 뷰가 유용하게 쓰인다.

## 병렬 Group By

병렬 sort group by 와 병렬 hash group by 즉 group by 키 정렬 순서에 따라 분배하느냐 해시 함수 결과값에 따라 분배하느냐의 차이다

group by 결과를 QC에게 전송할 때도 값 순서대로, 먼저 처리가 끝난 순서대로 진행한다.

### Group By가 두번 나타날 때의 처리과정

병렬 group by 실행게획에 group by가 두번 나타나는 경우가 있다.

첫번째 서버 집합이 읽은 데이터를 먼저 group by하고 두 번째 서버집합에 전송한다면 프로세스간 통신량이 1/10로 줄어 그만큼 병렬 처리 과정에서 생기는 병목을 줄일 수 있다.

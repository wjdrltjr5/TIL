# 소트가 발생하지 않도록 SQL 작성

데이터 모델 측면에서 이상이 없는데, 불필요한 소트가 발생하도록 SQL을 작성하는 경우가 있다. (ex. union all 사용해도 되는데 union사용)

distinct를 사용하는 경우도 매우 흔한데, 대부분 exists 서브쿼리로 대체함으로써 소트 연산을 없앨 수 있다.

```sql
-- 기존
select distinct 과금연월
from 과금
where 과금연월 <= :yyyymm
and 지역 like :reg || '%'

-- 개선
select 연월
from 연월테이블 a
where 연월 <= :yyyymm
and exists (
    select 'x'
    from 과금
    where 과금연월 = a.연월
    and 지역 like :reg || '%'
)
```

exists 서브쿼리의 가장 큰 특징은, 메인 쿼리로부터 건건이 입력 받은 값에 대한 조건을 만족하는 첫 번째 레코드를 만나는 순간 true를 반환하고 서브쿼리 수행을 마친다는 점이다.

# 소트를 발생시키는 오퍼레이션

## Sort Aggregate

sort aggregate는 아래처럼 전체 로우를 대상을 집계를 수행할 때 나타나는데 sort 라는 표현을 사용하지만 실제 소트가 발생하지는 않는다.

## Sort Order by

데이터 정렬을 위해 order by 오퍼레이션을 수행할 때 나타난다.

## Sort Group by

sort group by는 소팅 알고리즘을 사용해 그룹별 집계를 수행할 때 나타난다.

### Hash Group by와 비교

order by절을 명시하지 않으면 Hash Group by 방식으로 처리된다.

hash group by=는 정렬을 수행하지 않고 해싱 알고리즘을 사용해 데이터를 그룹핑한다.

읽는 로우마다 group by 컬럼의 해시 값으로 해시 버킷을 찾아 그룹별로 집계 항목등을 갱신하는 방식이다.

sort group by라고 해서 모든 데이터를 정렬하고 나서 집계하는 것은 아니며 hash group by와 마찬가지로 읽는 로우마다 그룹별로 집계항목을 갱신한다.

다만 그룹을 찾아가는 방식이 해싱 알고리즘이냐 소팅알고리즘이냐의 차이만 있을 뿐이다. (집계할 대상 로우가 아무리 많아도 그룹 개수가소수일때는 두 방식 차이 별로 없음)

### Group by 결과의 정렬순서

Sort Group by를 사용한다고해서 결과의 정렬순서를 보장하지는 않는다. 그냥 소팅 알고리즘을 사용해 결과를 집계할뿐

정렬된 group by 결과를 얻고자 한다면, 실행계획에 설령 sort group by라고 표시되더라도 반드시 order by를 명시해야 한다.

오라클은 distinct count를 만났을 땐 항상 sort group by 방식으로 수행한다.

## Sort Unique

Unnesting된 서브쿼리가 M쪽 집합이거나 Unique 인덱스가 없다면 그리고 세미조인으로 수행되지도 않는다면 메인 쿼리와 조인되기 전에 sort unique 오퍼레이션이 먼저 수행된다.

만약 PK/Unique 제약 또는 Unique 인덱스를 통해, Unnesting된 서브쿼리의 Uniqueness가 보장된다면 sort unique 오퍼레이션은 생략된다.

집합 연산자, distinct를 사용할때도 sort unique 오퍼레이션이 나타난다.

오라클 10gR2부터는 group by처럼 distinct 연산에서도 order by를 생략하면 hash unique 방식으로 수행된다.

## Sort Join

sort join 오퍼레이션은 소트 머지 조인을 수행할 때 나타난다

## Window Sort

window sort는 분석함수를 수행할 때 나타난다.

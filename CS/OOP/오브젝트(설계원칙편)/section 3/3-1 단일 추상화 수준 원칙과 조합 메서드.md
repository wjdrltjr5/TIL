# 단일 추상화 수준 원칙과 조합 메서드


## 메서드 작게 만들기

긴 메서드를 작은 메서드로 만들면 리팩토링하기가 용이해진다.
- 읽고 이해하기 쉬운 코드
- 버그 수정, 성능 최적화, 메서드 추가 용이
- 작은 메서드를 조합하면 일련의 주석을 읽는 것 같은 코드 작성 가능 (명확한 이름 부여 가능)
- 메서드의 재사용성 향상
- 메서드 오버라이딩 용이

### 의도를 드러내는 이름
어떻게 보다는 -> 무엇을

메서드의 이름은 메서드 호출자의 의도를 반영하도록 명명 메서드 호출자의 목표를 설명하고 이를 달성하는 메커니즘이나 알고리즘을 드러내지 말 것

사실 메서드의 길이보다는 메서드의 이름과 메서드 몸체 사이의 의미적 차이가 중요하다. 의미적 차이가 적다면 그대로 차이가 많이 난다면 수정

### 메서드 추출의 이유
- 가독성 향상
    - 메서드 안의 모든 코드가 동일한 추상화 수준에 있도록 만들기
    - 단일 추상화 수준 원칙
- 중복 코드 제거
- 불안정한 의존성 고립

### 단일 추상화 수준 원칙 SLAP : Single Level of Abstraction Principle
`메서드 내의 모든 코드는 동일한 추상화 수준에 취이해야 한다.` 메서드의 일부가 저수준의 데이터베이스 연결을 처리하고 다른 부분은 고수준의 비즈니스 코드를 처리하며, 또 다른 부분은 웹 서비스 관련 코드를 처리하는 일이 없어야 한다.

추상화 수준이 섞여있으면 코드를 이해하기 어렵다.

```java
public void run(){
    System.out.println("환영합니다."); // 저수준

    showRoom(); // 고수준

    System.out.println("다음 명령어를 사용할 수 있습니다."); // 저수준
    ...
}

public void showRoom(){
    System.out.println("당신은 ~~");

}
```

이렇게 수준이 섞여있다면 서로 다른 수준의 정보를 조합해야 한다.

```java
public void run(){
    welcome();
    play();
    farewell();
}

public void welcome(){
    System.out.println("환영합니다");
}
```

추상화 수준이 동일하다면 왔다갔다 할 필요없이 세부사항을 파악할 필요 없이 run메서드만 보고 파악가능 세부 내용이 궁금하면 필요한 고수준 메소드의 내부만 파악하면 된다.

> 프로그램을 하나의 명확한 작업을 하는 메서드들로 나누세요 메서드 내에 모든 작업이 동일한 추상화 수준으로 유지하세요 이렇게 하면 여러개의 작은 메서드로 이루어진 프로그램이 만들어지고 각 메서드는 몇 줄 정도로 짧아지게 된다.

### 저수준과 고수준
- 고수준 : 메서드 호출자의 목표를 설명
- 저수준 : 이를 달성하는 메커니즘이나 알고리즘

## 기존 파악하기 힘든 코드
저수준 + 중복코드 + 제어하기 어려운 불안정한 대상에 대한 의존(테스트 작성 어려움)
```java
 public void run() {
        // welcome 영역
        System.out.println("환영합니다!");
        System.out.println("당신은 [" + rooms[x + y * width].name() + "]에 있습니다.");
        System.out.println(rooms[x + y * width].description());
        System.out.println("다음 명령어를 사용할 수 있습니다.");
        System.out.println("go {north|east|south|west} - 이동, quit - 게임 종료");


        // play 영역
        Scanner scanner = new Scanner(System.in);

        running = true;
        while (running) {
            System.out.print("> ");
            String[] commands = scanner.nextLine().toLowerCase().trim().split("\\s+");
            switch (commands[0]) {
                case "go" -> {
                    switch (commands[1]) {
                        case "north" -> {
                            if (y - 1 < 0 || rooms[x + (y - 1) * width] == null) {
                                System.out.println("이동할 수 없습니다.");
                            } else {
                                y -= 1;
                                System.out.println("당신은 [" + rooms[x + y * width].name() + "]에 있습니다.");
                                System.out.println(rooms[x + y * width].description());
                            }
                        }
                        case "south" -> {
                            if (y + 1 >= height || rooms[x + (y + 1) * width] == null) {
                                System.out.println("이동할 수 없습니다.");
                            } else {
                                y += 1;
                                System.out.println("당신은 [" + rooms[x + y * width].name() + "]에 있습니다.");
                                System.out.println(rooms[x + y * width].description());
                            }
                        }
                        case "east" -> {
                            if (x + 1 >= width || rooms[(x + 1 ) + y * width] == null) {
                                System.out.println("이동할 수 없습니다.");
                            } else {
                                x += 1;
                                System.out.println("당신은 [" + rooms[x + y * width].name() + "]에 있습니다.");
                                System.out.println(rooms[x + y * width].description());
                            }
                        }
                        case "west" -> {
                            if (x - 1 < 0 || rooms[(x - 1) + y * width] == null) {
                                System.out.println("이동할 수 없습니다.");
                            } else {
                                x -= 1;
                                System.out.println("당신은 [" + rooms[x + y * width].name() + "]에 있습니다.");
                                System.out.println(rooms[x + y * width].description());
                            }
                        }
                        default -> System.out.println("이해할 수 없는 명령어입니다.");
                    }
                }

                case "quit" -> running = false;
                default -> System.out.println("이해할 수 없는 명령어입니다.");
            }
        }
        // farewell 영역
        System.out.println("\n게임을 종료합니다.");
    }
```
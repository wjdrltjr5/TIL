# 스와핑
프로세스가 실행되기 위해서는 프로세스의 명령어와 명령어가 접근하는 데이터가 메모리에 있어야 한다. 그러나 프로세스 또는 프로세스의 일부분은 실행 중에 임시로 백업 저장장치로 내보내어 졌다가 실행을 계속하기 위해 다시 메모리로 되돌아 올 수 있다. 

모든 프로세스의 물리 주소 공간 크기의 총합이 시스템의 실제 물리 메모리 크기보다 큰 경우에도 스와핑을 이용하면 동시에 실행하는 것이 가능하여 다중 프로그래밍의 정도를 증가시킨다.

## 9.5.1 기본 스와핑
표즌 스와핑에는 메인 메모리와 백업 저장장치 간에 전체 프로세스를 이동한다. 백업 저장장치는 일반적으로 빠른 보조저장장치다. 백업 저장장치는 프로세스의 크기에 상관없이 수용할 수 있을 만큼 커야 하며, 이러한 메모리 이미지에 직접 액세스할 수 있어야 한다.

프로세스 또는 일부가 백업 저장장치로 스왑될 때 프로세스와 관련된 자료구조는 백업 저장장치에 기록되어야 한다. 다중 스레드 프로세스의 경우 모든 스레드당 데이터 구조도 스왑되어야 한다.

또한 운영체제는 스왑아웃된 프로세스에 대한 메타데이터를 유지해야 메모리로 다시 스왑인될 때 복원될 수 있다.

표준 스와핑의 장점은 실제 물리 메모리보다 더 많은 프로세스를 수용할 수 있도록 물리 메모리가 초과 할당될 수 있다는 것이다. 유휴 또는 대부분의 시간을 유휴 상태로 보내는 프로세스가 스와핑에 적합한 후보이다.

이러한 비활성 프로세스에 할당된 모든 메모리는 활성 프로세스에 할당 될 수 있다. 스왑된 비활성 프로세스가 다시 활성화 되면 다시 스왑인 해야 한다.

## 9.5.2 페이징에서의 스와핑
표준 스와핑은 기존  UNIX 시스템에서 사용되었지만 메모리와 백업 저장장치 간에 프로세스 전체를 이동하는 데 걸리는 시간이 엄청나기 떄문에 일반적으로 최신 운영체제에서는 더는 사용되지 않는다.

Linux 및 Windows를 포함한 대부분의 시스템은 이제 프로세스 전체를 아닌 프로세스 페이지를 스왑할 수 있는 변형 스와핑을 사용한다.

이 전략은 여전히 물리 메모리를 초과 할당할 수 있지만 프로세스 전체를 스오바하는 비용은 발생하지 않ㄴ느다. 단지 적은 수의 페이지만 스왑에 관여하기 때문이다.

실제로 스와핑이라는 용어는 일반적으로 표준 스와핑을 말하며 페이징은 피이징에서의 스와핑을 의미한다. 페이지-아웃 연산은 페이지를 메모리에서 백업 저장장치로 이동시킨다. 반대 반향의 연산은 페이지-인이라고 한다.

## 9.5.3 모바일 시스템에서의 스와핑
PC와 서버 대부분의 운영체제는 페이지 스와핑을 지원한다. 이와는 대조적으로 모바일 시스템은 어떠한 형태의 스와핑도 지원하지 않는 것이 일반적이다.

일반적으로 모바일 장치들은 비휘발성 저장장치로 공간을 많이 자치하는 하드디스크보다 플래스 메모리를 사용한다. 이 결과 저장 공간이 줄어드는 것이 모바일 운영체제의 설계자가 스와핑을 피하게 되는 여러 이유 중으 ㅣ하나가 된다.

다른 이유로는 플래시 메모리가 사용이 불가능해질 때까지 허용된느 쓰기 횟수가 정해져 있다는 사실과 이러한 장치들의 메모리와 플래시 메모리의 처리량이 저조하다는 사실을 들 수 있다.

스와핑을 사용하는 대신 가용메모리가 정해진 임계값보다 떨어지면 IOS는 응용에 할당된 메모리를 자발적으로 반환하도록 요청한다. 코드와 같은 읽기 전용 데이터는 필요에 따라 메인 메모리로부터 제거되고 나중에 플래시 메모리로부터 적재될 수 있다. 스택과 같은 변경된 데이터는 절대 제거될 수 없다. 충분한 메모리를 반환하지 못한 응용은 운영체제에 의해 종료될 수 있다.

Android도 유사한 정책을 채택하였다. 가용 메모리가 부족해지면 프로세스를 종료시키는 것이 가능하다. 프로세스를 종료하기 전에 응용의 상태를 플래시 메모리에 저장하여 나중에 빠르게 재시작 할 수 있게 한다.

모바일 개발자들은 응용이 너무 많은 메모리를 사용하거나 메모리 누수로 고생하지 않도록 주의해서 메모리를 할당하고 반환해야 한다.
# Distributed Relational Database (분산 관계형 데이터 베이스)

-   분산이 중점
-   왜 분산이 필요할까

DB장비를 무한정 스케일업하는 것은 한계가 있다. 스케일 아웃을 고려

## 데이터베이스 분산 방법 (샤딩)

-   샤딩
    -   조인 또는 트랜재션 관리 등의 어려움
    -   수직 샤딩
        -   칼럼기준
        -   확장 제한
    -   수평 샤딩
        -   데이터 기준
        -   확장 용이

## 샤딩 기법

-   Range Based Sharding : 범위 기반 샤딩 (수평 샤딩 ex. 날짜를 기준 or 키를 기준)

    -   쏠림 현상 있을 수 있음

-   Hash Based Sharding : 해시 함수를 사용하여 데이터를 분할할 때 사용한다. 특정 컬럼의 값을 해싱하여 저장 (여러 컬럼 해싱 비권장)

    -   쏠림 현상 있을 수 있음

-   Directory Based Sharding : 디렉토리를 이용하여 데이터가 저장된 샤드를 관리하는 기법
    -   매핑 테이블을 이용하여 각 테이터가 저장된 샤드를 관리
    -   디렉토리 관리 비용이 있지만 데이터 규모에 따라 유연한 관리 가능

## 물리적 샤드 , 논리적 샤드

-   물리적 샤드 : 샤드를 물리적으로 늘림
    -   물리적으로 샤드 추가시 애플리케이션 코드를 수정하는등 샤로운 샤드 정보를 알아야 함
        -   DB의 확장으로 인해 애플리케이션도 영향
    -   기존에 저장된 값 재배치도 필요
-   논리적 샤드 : 샤드를 논리적으로 분리 유연한 매핑
    -   개념적으로 데이터를 분할
    -   논리 샤드와 물리 샤드를 연결 해주는 라우터를 만들어야 한다.
    -   애플리케이션은 논리적 샤드를 기반으로 요청
    -   물리적으로 샤드가 늘어낼때 값 재배치는 필요하지만 애플리케이션은 영향 x

## 데이터 복제

마스터 슬레이브와 같은 유사한 개념이지만 시스템이나 목적에 따라 다르게 사용되기도 한다.

복제는 동기적/비동기적 실행

-   동기적 실행시 : 일관성 보장 쓰기 성능 저하
-   비동기적 실행 : 쓰기 성능 유지, 일관성 보장 x

## 파티셔닝과 샤딩의 차이

### 1. 파티셔닝 (Partitioning)

-   **정의**:  
    하나의 큰 테이블을 논리적으로 여러 개의 작은 단위(파티션)로 분할하는 기법입니다.  
    분할된 데이터는 `동일한 데이터베이스` 내에서 관리됩니다.

-   **주요 특징**:

    -   **논리적 분할**: 데이터가 물리적으로 분리되지 않고, 하나의 데이터베이스 내에서 논리적으로 나뉩니다.
    -   **쿼리 성능 개선**: 특정 파티션만 스캔하게 함으로써 쿼리 성능을 최적화할 수 있습니다.
    -   **관리 용이성**: 데이터의 보관 및 삭제, 백업 작업 등을 파티션 단위로 관리할 수 있습니다.
    -   **분할 기준**: 범위(Range), 리스트(List), 해시(Hash) 등 다양한 기준으로 분할할 수 있습니다.

-   **예시**:  
    거래 데이터를 날짜별로 파티셔닝하여, 특정 날짜 범위의 데이터를 빠르게 조회할 수 있도록 하는 경우.

### 2. 샤딩 (Sharding)

-   **정의**:  
    하나의 큰 데이터베이스를 `여러 개의 독립적인 데이터베이스` 서버(노드)로 물리적으로 분산시키는 기법입니다.

-   **주요 특징**:

    -   **물리적 분산**: 데이터가 여러 서버에 분산되어 저장되므로, 하나의 서버에 과부하가 발생하는 것을 방지할 수 있습니다.
    -   **수평적 확장성**: 데이터가 증가하거나 트래픽이 많아질 경우, 새로운 서버(샤드)를 추가하여 확장이 가능합니다.
    -   **독립적 운영**: 각 샤드는 독립적으로 관리되며, 데이터 일관성 및 분산 트랜잭션 등의 이슈를 고려해야 합니다.
    -   **부하 분산**: 분산된 샤드를 통해 여러 서버에 부하를 분산시켜 전체 시스템의 성능을 향상시킬 수 있습니다.

-   **예시**:  
    사용자 데이터를 사용자 ID의 해시 값을 기준으로 여러 서버에 분산 저장하여, 각 서버가 일정한 사용자 그룹을 담당하도록 하는 경우.

### 요약

| **항목**      | **파티셔닝 (Partitioning)**                                      | **샤딩 (Sharding)**                                                |
| ------------- | ---------------------------------------------------------------- | ------------------------------------------------------------------ |
| **분할 방식** | 하나의 데이터베이스 내에서 논리적으로 분할                       | 여러 데이터베이스 서버(노드)로 물리적으로 분산                     |
| **주요 목적** | 쿼리 성능 최적화, 관리 용이성                                    | 수평 확장성 확보, 부하 분산, 고가용성 확보                         |
| **관리**      | 중앙 집중식 관리 (하나의 DBMS에서 관리)                          | 분산 관리 (각 샤드 별로 독립적 관리 필요)                          |
| **복잡성**    | 상대적으로 단순 (내부적인 파티션 관리)                           | 상대적으로 복잡 (데이터 일관성, 분산 트랜잭션 등 고려 필요)        |
| **적용 사례** | 대용량 테이블에서 특정 범위의 데이터 조회, 보관 및 유지보수 개선 | 사용자 수가 매우 많거나 트래픽이 높은 환경에서 서버 부하 분산 필요 |

---
